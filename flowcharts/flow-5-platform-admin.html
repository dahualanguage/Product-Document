<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Flow 5 â€” Platform Administration</title>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      color: #1e293b; background: #f1f5f9; line-height: 1.5; font-size: 14px;
      display: flex; min-height: 100vh;
    }
    .sidebar {
      width: 260px; min-width: 260px; background: #fff;
      border-right: 1px solid #e2e8f0;
      display: flex; flex-direction: column;
      position: fixed; top: 0; left: 0; bottom: 0; z-index: 100;
      transition: width .25s, min-width .25s; overflow: hidden;
    }
    .sidebar.collapsed { width: 48px; min-width: 48px; }
    .sidebar-brand {
      padding: 20px 16px 12px; border-bottom: 1px solid #e2e8f0;
      display: flex; align-items: center; gap: 10px; white-space: nowrap; overflow: hidden;
    }
    .sidebar-brand h2 { font-size: 15px; font-weight: 800; color: #0f172a; transition: opacity .2s; }
    .sidebar.collapsed .sidebar-brand h2 { opacity: 0; pointer-events: none; }
    .sidebar-toggle {
      width: 28px; height: 28px; border-radius: 6px; border: 1px solid #e2e8f0;
      background: #f8fafc; cursor: pointer; display: flex; align-items: center;
      justify-content: center; flex-shrink: 0; color: #64748b;
    }
    .sidebar-toggle:hover { background: #e2e8f0; }
    .sidebar-nav { flex: 1; overflow-y: auto; padding: 8px 0; }
    .nav-item {
      display: flex; align-items: center; gap: 10px; padding: 10px 16px;
      color: #475569; font-size: 13px; font-weight: 600; text-decoration: none;
      border-left: 3px solid transparent; transition: all .15s;
      white-space: nowrap; overflow: hidden;
    }
    .nav-item:hover { background: #f8fafc; color: #1e293b; }
    .nav-item.active { background: #eff6ff; color: #1d4ed8; border-left-color: #3b82f6; }
    .nav-dot {
      width: 24px; height: 24px; border-radius: 6px; display: flex;
      align-items: center; justify-content: center;
      color: #fff; font-weight: 800; font-size: 11px; flex-shrink: 0;
    }
    .nav-label { transition: opacity .2s; }
    .sidebar.collapsed .nav-label { opacity: 0; }

    .main { flex: 1; margin-left: 260px; padding: 32px 40px; transition: margin-left .25s; }
    .sidebar.collapsed ~ .main { margin-left: 48px; }
    .page-header { margin-bottom: 24px; }
    .page-header h1 { font-size: 26px; font-weight: 800; color: #0f172a; margin-bottom: 4px; }
    .page-header p { color: #64748b; font-size: 14px; }

    .swimlane-overflow { overflow-x: auto; }
    .swimlane {
      display: flex; border: 2px solid #e2e8f0; border-radius: 10px;
      overflow: hidden; background: #fff; box-shadow: 0 1px 8px rgba(0,0,0,.03);
    }
    .lane {
      flex: 1; min-width: 210px; border-right: 1.5px dashed #e2e8f0;
      display: flex; flex-direction: column;
    }
    .lane:last-child { border-right: none; }
    .lane-header {
      padding: 12px 10px; text-align: center; font-weight: 700; font-size: 12px;
      letter-spacing: .3px; border-bottom: 2px solid rgba(0,0,0,.08);
    }
    .lane-body {
      flex: 1; padding: 14px 10px; min-height: 280px;
      display: flex; flex-direction: column; align-items: center; gap: 8px;
    }

    .color-admin   .lane-header { background: #fef2f2; color: #991b1b; }
    .color-teacher .lane-header { background: #eef2ff; color: #3730a3; }
    .color-system  .lane-header { background: #f5f3ff; color: #5b21b6; }

    .node {
      padding: 9px 12px; border-radius: 8px; text-align: center;
      font-size: 11px; font-weight: 600; line-height: 1.4;
      width: 90%; max-width: 155px; position: relative;
    }
    .node-process { background: #dbeafe; color: #1e40af; border: 1.5px solid #93c5fd; }
    .node-start { background: #e0e7ff; color: #3730a3; border: 1.5px solid #a5b4fc; border-radius: 50px; padding: 7px 14px; }
    .node-end { background: #fce7f3; color: #9d174d; border: 1.5px solid #f9a8d4; border-radius: 50px; padding: 7px 14px; }
    .node-decision { background: #fef9c3; color: #854d0e; border: 1.5px solid #fde047; border-radius: 4px; font-size: 10.5px; }
    .node-decision::before {
      content: ""; position: absolute; top: -1px; left: -1px; right: -1px; bottom: -1px;
      border: 1.5px solid #fde047; border-radius: 4px;
      clip-path: polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%); pointer-events: none;
    }
    .node-gate { background: #fff1f2; color: #be123c; border: 1.5px dashed #fda4af; font-size: 10.5px; }

    .arrow-down {
      width: 2px; height: 18px; background: #94a3b8; position: relative; margin: 0 auto;
    }
    .arrow-down::after {
      content: ""; position: absolute; bottom: -5px; left: 50%; transform: translateX(-50%);
      border-left: 5px solid transparent; border-right: 5px solid transparent; border-top: 6px solid #94a3b8;
    }
    .arrow-label { font-size: 10px; color: #64748b; font-weight: 600; margin: -3px 0 -2px; text-align: center; }
    .spacer { flex: 1; }
    .gap { height: 26px; }
    .note {
      padding: 7px 10px; border-radius: 6px; font-size: 10px;
      font-weight: 500; line-height: 1.4; text-align: center;
      width: 90%; max-width: 155px;
    }
    .note-info { background: #f0f9ff; color: #0369a1; border: 1px solid #bae6fd; }
    footer { text-align: center; padding: 24px 0; color: #94a3b8; font-size: 12px; border-top: 1px solid #e2e8f0; margin-top: 40px; }

    @media (max-width: 768px) {
      .sidebar { width: 48px; min-width: 48px; }
      .sidebar .nav-label { opacity: 0; }
      .sidebar .sidebar-brand h2 { opacity: 0; }
      .main { margin-left: 48px; padding: 16px; }
      .lane { min-width: 170px; }
    }
  </style>
</head>
<body>

<aside class="sidebar" id="sidebar">
  <div class="sidebar-brand">
    <button class="sidebar-toggle" id="sidebarToggle" title="Toggle sidebar">
      <svg width="16" height="16" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"/></svg>
    </button>
    <h2>Flow Diagrams</h2>
  </div>
  <nav class="sidebar-nav">
    <a class="nav-item" href="index.html">
      <span class="nav-dot" style="background:#64748b;"><svg width="12" height="12" viewBox="0 0 20 20" fill="#fff"><path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"/><path fill-rule="evenodd" d="M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3zm-3 4a1 1 0 100 2h.01a1 1 0 100-2H7zm3 0a1 1 0 100 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"/></svg></span>
      <span class="nav-label">Legend</span>
    </a>
    <a class="nav-item" href="flow-1-authentication.html">
      <span class="nav-dot" style="background:#6366f1;">1</span>
      <span class="nav-label">Authentication</span>
    </a>
    <a class="nav-item" href="flow-2-content-creation.html">
      <span class="nav-dot" style="background:#10b981;">2</span>
      <span class="nav-label">Content Creation</span>
    </a>
    <a class="nav-item" href="flow-3-student-practice.html">
      <span class="nav-dot" style="background:#f59e0b;">3</span>
      <span class="nav-label">Student Practice</span>
    </a>
    <a class="nav-item" href="flow-4-school-management.html">
      <span class="nav-dot" style="background:#ef4444;">4</span>
      <span class="nav-label">School Management</span>
    </a>
    <a class="nav-item active" href="flow-5-platform-admin.html">
      <span class="nav-dot" style="background:#8b5cf6;">5</span>
      <span class="nav-label">Platform Admin</span>
    </a>
    <a class="nav-item" href="flow-6-live-classroom.html">
      <span class="nav-dot" style="background:#0ea5e9;">6</span>
      <span class="nav-label">Live Classroom</span>
    </a>
  </nav>
</aside>

<div class="main">
  <div class="page-header">
    <h1>5. Platform Administration</h1>
    <p>Admin-only operations: user management, school management, billing &amp; credits.</p>
  </div>

  <div class="swimlane-overflow">
    <div class="swimlane" style="min-width:660px;">

      <!-- ADMIN -->
      <div class="lane color-admin">
        <div class="lane-header">ADMIN</div>
        <div class="lane-body">
          <div class="node node-start">Start</div>
          <div class="arrow-down"></div>
          <div class="node node-process" style="background:#fef2f2; border-color:#fca5a5; color:#991b1b;">User Management<br>(CRUD all users)</div>
          <div class="arrow-down"></div>
          <div class="node node-process">Assign roles<br>&amp; permissions</div>
          <div class="arrow-down"></div>
          <div class="node node-process">Set subscription<br>type &amp; plan</div>
          <div class="arrow-down"></div>
          <div class="node node-process" style="background:#fef2f2; border-color:#fca5a5; color:#991b1b;">School Management<br>(Create / CSV / Close trial)</div>
          <div class="arrow-down"></div>
          <div class="node node-decision">Close trial?</div>
          <div class="arrow-label">Yes &darr;</div>
          <div class="arrow-down"></div>
          <div class="node node-gate">closeSchoolTrial<br>downgrades all<br>school users</div>
          <div class="arrow-down"></div>
          <div class="node node-process">View all platform<br>data &amp; reports</div>
        </div>
      </div>

      <!-- SYSTEM / BILLING -->
      <div class="lane color-system">
        <div class="lane-header">SYSTEM / BILLING</div>
        <div class="lane-body">
          <div class="gap"></div>
          <div class="gap"></div>
          <div class="gap"></div>
          <div class="gap"></div>
          <div class="node node-process">Stripe processes<br>payment</div>
          <div class="arrow-down"></div>
          <div class="node node-decision">Plan active?<br>(hasValidPlan)</div>
          <div class="arrow-label">Yes &darr;</div>
          <div class="arrow-down"></div>
          <div class="node node-process">Grant credits<br>&amp; feature access</div>
          <div class="arrow-down"></div>
          <div class="node node-decision">Credits<br>remaining?</div>
          <div class="arrow-label">No &darr;</div>
          <div class="arrow-down"></div>
          <div class="node node-gate">Block AI operations<br>(eligibleForPaidFunc<br>= false)</div>
        </div>
      </div>

      <!-- TEACHER -->
      <div class="lane color-teacher">
        <div class="lane-header">TEACHER<br><span style="font-weight:400; font-size:11px;">(individual user)</span></div>
        <div class="lane-body">
          <div class="gap"></div>
          <div class="gap"></div>
          <div class="gap"></div>
          <div class="node node-process">Open billing page<br>(account popover menu)</div>
          <div class="arrow-down"></div>
          <div class="node node-decision">Choose plan</div>
          <div class="arrow-label">&darr;</div>
          <div class="arrow-down"></div>
          <div class="node node-process">Starter (Free)<br>Top-up ($5)<br>Basic ($15/mo)</div>
          <div class="arrow-down"></div>
          <div class="node node-process">Pay via Stripe</div>
          <div class="arrow-down"></div>
          <div class="node node-process">View credit<br>balance &amp; expiry</div>
          <div class="arrow-down"></div>
          <div class="node node-end">Use credits for<br>AI operations</div>
          <div class="note note-info" style="margin-top:6px;">Billing is in account<br>popover menu, NOT<br>in sidebar</div>
        </div>
      </div>

    </div>
  </div>

  <footer>DAHUA AI &middot; Flow Diagrams &middot; February 2026</footer>
</div>

<script>
  const sidebar = document.getElementById('sidebar');
  document.getElementById('sidebarToggle').addEventListener('click', () => {
    sidebar.classList.toggle('collapsed');
    const svg = document.querySelector('#sidebarToggle svg');
    svg.style.transform = sidebar.classList.contains('collapsed') ? 'rotate(180deg)' : '';
  });
</script>
</body>
</html>
